{% trans_default_domain "charity" %}
<div id="configurator" data-ng-class="{fullscreen: fullscreen}">
    <div id="topnav">
        <nav class="layouts">
            <button data-ng-click="bannerPosition = 'center'">
                {% image '@DothivPremiumConfiguratorBundle/Resources/public/images/banner-position-center.png' %}
                <img src="{{ asset_url }}" alt="{% trans %}pc.preview.center{% endtrans %}" data-ng-show="bannerPosition == 'center'">
                {% endimage %}
                {% image '@DothivPremiumConfiguratorBundle/Resources/public/images/banner-position-center-off.png' %}
                <img src="{{ asset_url }}" alt="{% trans %}pc.preview.center{% endtrans %}" data-ng-show="bannerPosition != 'center'">
                {% endimage %}
            </button>
            <button data-ng-click="bannerPosition = 'top'">
                {% image '@DothivPremiumConfiguratorBundle/Resources/public/images/banner-position-top.png' %}
                <img src="{{ asset_url }}" alt="{% trans %}pc.preview.top{% endtrans %}" data-ng-show="bannerPosition == 'top'">
                {% endimage %}
                {% image '@DothivPremiumConfiguratorBundle/Resources/public/images/banner-position-top-off.png' %}
                <img src="{{ asset_url }}" alt="{% trans %}pc.preview.top{% endtrans %}" data-ng-show="bannerPosition != 'top'">
                {% endimage %}
            </button>
            <button data-ng-click="bannerPosition = 'right'">
                {% image '@DothivPremiumConfiguratorBundle/Resources/public/images/banner-position-right.png' %}
                <img src="{{ asset_url }}" alt="{% trans %}pc.preview.right{% endtrans %}" data-ng-show="bannerPosition == 'right'">
                {% endimage %}
                {% image '@DothivPremiumConfiguratorBundle/Resources/public/images/banner-position-right-off.png' %}
                <img src="{{ asset_url }}" alt="{% trans %}pc.preview.right{% endtrans %}" data-ng-show="bannerPosition != 'right'">
                {% endimage %}
            </button>
        </nav>
        <nav class="preview">
            <button data-ng-click="fullscreen = true" data-ng-show="!fullscreen">
                {% trans %}pc.preview.fullscreen{% endtrans %}
            </button>
            <button data-ng-click="fullscreen = false" data-ng-show="fullscreen">
                {% trans %}pc.preview.fullscreen.close{% endtrans %}
            </button>
            <button class="primary">
                {% trans %}pc.preview.finish{% endtrans %}
            </button>
        </nav>
    </div>
    <iframe src="%iframeUrl%" data-ng-init="iframeUrl='{{ path('dothiv_premiumconfig_preview', {'domain': app.request.get('domain'), 'locale': app.request.get('locale')}) }}'" data-ng-style="iframeStyle"></iframe>
    <div id="settings" data-ng-hide="fullscreen">
        <header>
            <div class="inner">
                <nav>
                    <button data-ng-click="settings = 'general'" data-ng-class="{active: settings == 'general'}">
                        {% trans %}pc.settings.general{% endtrans %}
                    </button>
                    <button data-ng-click="settings = 'images'" data-ng-class="{active: settings == 'images'}">
                        {% trans %}pc.settings.images{% endtrans %}
                    </button>
                    <button data-ng-click="settings = 'colors'" data-ng-class="{active: settings == 'colors'}">
                        {% trans %}pc.settings.colors{% endtrans %}
                    </button>
                    <button data-ng-click="settings = 'fonts'" data-ng-class="{active: settings == 'fonts'}">
                        {% trans %}pc.settings.fonts{% endtrans %}
                    </button>
                    <button data-ng-click="settings = 'style'" data-ng-class="{active: settings == 'style'}">
                        {% trans %}pc.settings.style{% endtrans %}
                    </button>
                    <button data-ng-click="settings = 'extras'" data-ng-class="{active: settings == 'extras'}">
                        {% trans %}pc.settings.extras{% endtrans %}
                    </button>
                </nav>
            </div>
        </header>
        <div class="main">
            <div class="inner">
                <section data-ng-show="settings == 'general'">
                    <form role="form" novalidate name="bannerForm">
                        <fieldset>
                            <div class="form-group">
                                <label for="redirect_url">{% trans %}
                                    pc.settings.general.redirecturl{% endtrans %}</label>
                                <input type="url" id="redirect_url" data-ng-model="banner.redirect_url" data-ng-blur="updateBannerSettings()">
                            </div>
                        </fieldset>
                    </form>
                </section>
                <section data-ng-show="settings == 'images'">
                    {% image '@DothivPremiumConfiguratorBundle/Resources/public/images/empty-image.svg' %}

                    <form role="form" novalidate name="imagesForm">
                        {% set imageType = 'visual' %}
                        {% block imageupload %}
                            <fieldset class="imageupload">
                                <label for="image-{{ imageType }}">
                                    <img src="{{ asset_url }}" alt="" data-ng-hide="premiumBanner.{{ imageType }}">
                                    <img data-ng-src="%premiumBanner.{{ imageType }}%" alt="" data-ng-show="premiumBanner.{{ imageType }}">
                                    {{ ('pc.image.' ~ imageType ~ '.name')|trans }}<br>
                                    <small>{{ ('pc.image.' ~ imageType ~ '.description')|trans }}</small>
                                    <div class="progress" data-ng-repeat="item in {{ imageType }}Uploader.queue" data-ng-show="{{ imageType }}Uploader.isUploading">
                                        <div class="progress-bar progress-bar-info" role="progressbar" data-ng-style="{ 'width': item.progress + '%' }"></div>
                                    </div>
                                </label>
                                <nav>
                                    <label for="image-{{ imageType }}" data-ng-hide="{{ imageType }}Uploader.isUploading">{% trans %}pc.image.button.change{% endtrans %}</label>
                                    <button type="reset" data-ng-show="premiumBanner.{{ imageType }}" data-ng-click="premiumBanner.{{ imageType }} = null">{% trans %}pc.image.button.remove{% endtrans %}</button>
                                </nav>
                                <input type="file" id="image-{{ imageType }}" data-nv-file-select data-uploader="{{ imageType }}Uploader">
                            </fieldset>
                        {% endblock %}
                        {% set imageType = 'bg' %}
                        {{ block('imageupload') }}
                    </form>
                    {% endimage %}
                </section>
                <section data-ng-show="settings == 'colors'">
                    <form role="form" novalidate name="colorsForm">
                        {% set colorType = 'font' %}
                        {% block colorpicker %}
                            <fieldset class="color">
                                <label for="color-{{ colorType }}">
                                    {{ ('pc.color.' ~ colorType ~ '.name')|trans }}
                                </label>
                                <label for="color-{{ colorType }}" class="preview" data-ng-style="{ 'background-color': premiumBanner.{{ colorType }}Color }">
                                </label>
                                <input type="text" data-colorpicker data-colorpicker-position="top" data-ng-pattern="/^#([0-9A-Fa-f]{3}){1,2}$/" id="color-{{ colorType }}" data-ng-model="premiumBanner.{{ colorType }}Color">
                            </fieldset>
                        {% endblock %}
                        {% set colorType = 'bg' %}
                        {{ block('colorpicker') }}
                        {% set colorType = 'bar' %}
                        {{ block('colorpicker') }}
                    </form>
                </section>
                <section data-ng-show="settings == 'fonts'">
                    <form role="form" novalidate name="fontsForm">
                        {% set fontType = 'headline' %}
                        {% block font %}
                            <fieldset class="font">
                                <div class="form-group">
                                    <label for="font-{{ fontType }}">
                                        {{ ('pc.font.' ~ fontType ~ '.name')|trans }}
                                    </label>
                                    <input type="text"
                                            id="font-{{ fontType }}"
                                            data-ng-model="fontsForm.{{ fontType }}FontLabel"
                                            data-typeahead="font as font.family for font in fonts | filter:$viewValue | limitTo:8"
                                            data-typeahead-on-select="{{ fontType }}FontSelected($item, $model, $label)"
                                            >
                                </div>
                                <div class="form-group" data-ng-show="fontsForm.{{ fontType }}FontLabel && fontsForm.{{ fontType }}Font">
                                    <label for="font-{{ fontType }}Style">
                                        {{ ('pc.font.' ~ fontType ~ '.style')|trans }}<br>
                                    </label>
                                    <select name="{{ fontType }}FontStyle" id="font-{{ fontType }}Style"
                                            data-ng-model="premiumBanner.{{ fontType }}FontStyle"
                                            data-ng-options="style for style in fontsForm.{{ fontType }}Font.variants"
                                            >
                                    </select>
                                </div>
                            </fieldset>
                        {% endblock %}
                        {% set fontType = 'text' %}
                        {{ block('font') }}
                        <div class="intro" data-ng-hide="fontsForm.headlineFontLabel || fontsForm.textFontLabel">
                            <em>{% trans %}pc.font.intro{% endtrans %}</em>
                        </div>
                    </form>
                </section>
            </div>
        </div>
    </div>
</div>
<script type="text/ng-template" id="forbidden.html">
    {% set modal = content('Block', 'pc.errormodal.forbidden') %}
    <header>
        <h2>{{ modal.title }}</h2>
    </header>
    <article>
        {{ modal.text|markdown }}
    </article>
</script>
<script type="text/ng-template" id="uploadfailed.html">
    {% set modal = content('Block', 'pc.errormodal.uploadfailed') %}
    <header>
        <h2>{{ modal.title }} (Code: %code%)</h2>
    </header>
    <article>
        {{ modal.text|markdown }}
    </article>
    <footer>
        <button data-ng-click="$dismiss()">Close</button>
    </footer>
</script>
